!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=jQuery},function(t,e){t.exports=jui},function(t,e,n){n(4),n(3)},function(t,e,n){"use strict";n.r(e);var i=n(0),o=n.n(i),s=n(1),r=n.n(s),l={name:"event",extend:"core",component:function(){var t=r.a.include("util.base"),e=r.a.include("manager"),n=r.a.include("collection"),i=function(){var t=null;this.find=function(t){return o()(this.root).find(t)},this.addEvent=function(){this.listen.add(arguments)},this.addTrigger=function(t,e){this.listen.trigger(t,e)},this.setVo=function(){this.options.vo&&(null!=t&&t.reload(),t=o()(this.selector).jbinder(),this.bind=t)},this.destroy=function(){for(var t=0;t<this.listen.size();t++){var e=this.listen.get(t);o()(e.target).off(e.type)}if(this.__proto__)for(var n in this.__proto__)delete this.__proto__[n]}};return i.build=function(i){return function(s,l){var h=[],u=o()(s||"<div />");return u.each(function(e){h[e]=r.a.createUIObject(i,u.selector,e,this,l,function(e,n){e.init.prototype.listen=new function(){var e=[];function n(t){for(var n=["webkit","moz","MS","o",""],i=0;i<n.length;i++){var s=t.type;n[i]||(s=s.toLowerCase()),o()(t.target).on(n[i]+s,t.callback)}e.push(t)}function i(t){t.callback&&!t.children?o()(t.target).on(t.type,t.callback):o()(t.target).on(t.type,t.children,t.callback),e.push(t)}function s(t){t.callback&&!t.children?o()(t.target).on(r(t.type),t.callback):o()(t.target).on(r(t.type),t.children,t.callback),e.push(t)}function r(t){return{click:"touchstart",dblclick:"touchend",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}[t]}this.add=function(e){var r={target:e[0],type:e[1]};t.typeCheck("function",e[2])?r=o.a.extend(r,{callback:e[2]}):t.typeCheck("string",e[2])&&(r=o.a.extend(r,{children:e[2],callback:e[3]}));for(var l=t.typeCheck("array",r.type)?r.type:[r.type],h=0;h<l.length;h++)r.type=l[h],-1!=r.type.toLowerCase().indexOf("animation")?n(r):("body"!=r.target&&r.target!=window&&r.target!=document&&o()(r.target).off(r.type),t.isTouch?s(r):i(r))},this.trigger=function(e,n){o()(e).trigger(t.isTouch?r(n):n)},this.get=function(t){return e[t]},this.getAll=function(){return e},this.size=function(){return e.length}},o()("script").each(function(t){if(s==o()(this).data("jui")||s==o()(this).data("vo")||s instanceof HTMLElement){var e=o()(this).data("tpl");if(""==e)throw new Error("JUI_CRITICAL_ERR: 'data-tpl' property is required");n.tpl[e]=o()(this).html()}})})}),e.add(new n(i.type,s,l,h)),0==h.length?null:1==h.length?h[0]:h}},i.init=function(t){var n=null;return"object"==typeof t&&(n=i.build(t),e.addClass({type:t.type,class:n})),n},i.setup=function(){return{vo:null}},i}};r.a.redefine("jquery",[],function(){return o.a}),r.a.use(l);var h=r.a,u={name:"grid.column",component:function(){return function(t){this.element=null,this.order=null,this.name=null,this.data=[],this.list=[],this.index=t,this.type="show",this.width=null,this.hide=function(){this.type="hide",o()(this.element).hide()},this.show=function(){this.type="show",o()(this.element).show()}}}},a={name:"grid.row",component:function(){const t=h.include("util.base");var e=function(){this.data=null,this.seq=0,this.rownum=null,this.index=null,this.element=null,this.list=[],this.hidden={},this.parent=null,this.children=[],this.depth=0,this.type="fold",this.tpl=null,this.init=function(t,e,n){this.data=t,this.tpl=e,this.parent=n}};return e.prototype=new function(){function e(e,n){return e.tpl?(null!=n&&function(e,n){for(var i in e.data)n[i]&&t.typeCheck("string",e.data[i])&&(e.data[i]=e.data[i].replace(/</g,"&lt;").replace(/>/g,"&gt;"))}(e,n),o()(e.tpl(o.a.extend({row:{type:e.type,index:e.index,seq:e.seq,data:e.data,depth:e.depth,children:e.children}},e.data))).get(0)):e.element}function n(t){o()(t.element).remove();for(var e=0;e<t.children.length;e++){var i=t.children[e];i.isLeaf()?o()(i.element).remove():n(i)}}function i(t){for(var e=0;e<t.length;e++)t[e].setIndex(e),t[e].reload()}this.setIndex=function(t){this.rownum=isNaN(t)?this.rownum:t,this.seq=this.rownum+1,this.parent?this.index=this.parent.index+"."+this.rownum:this.index=""+this.rownum,this.parent&&"string"==typeof this.index&&(this.depth=this.index.split(".").length-1),this.isLeaf()||function t(e){for(var n=e.children,i=0;i<n.length;i++)n[i].setIndex(i),n[i].reload(),n[i].isLeaf()||t(n[i])}(this)},this.reload=function(t,n,i){if(null!=this.element){var s=e(this,i),r=o()(this.element).attr("class");o()(s).addClass(r).insertAfter(this.element),o()(this.element).remove(),this.element=s}else this.element=e(this,i);if(null!=t)for(var l=0;l<t.length;l++)"hide"==t[l].type?this.hideCell(l):this.showCell(l);null!=n&&(this.seq=n),function(t){t.list=[],o()(t.element).find("td").each(function(e){t.list[e]=this,t.hidden[e]&&(this.style.display="none")})}(this)},this.destroy=function(){null!=this.parent?this.parent.removeChild(this.index):(n(this),o()(this.element).remove())},this.isLeaf=function(){return 0==this.children.length},this.fold=function(){this.type="fold";for(var t=0;t<this.children.length;t++){var e=this.children[t];o()(e.element).hide(),e.isLeaf()||e.fold()}},this.open=function(){this.type="open";for(var t=0;t<this.children.length;t++){var e=this.children[t];o()(e.element).show(),e.isLeaf()||e.open()}},this.appendChild=function(t){var e=this.isLeaf()?this.element:this.lastChildLeaf().element;o()(t.element).insertAfter(e),this.children.push(t)},this.insertChild=function(t,e,n){var s=this.element;if(t>0){var r=this.children[t-1];s=r.isLeaf()&&this.children.length!=t+1?r.element:r.lastChildLeaf().element}o()(e.element).insertAfter(s);var l=this.children.splice(0,t);l.push(e),this.children=l.concat(this.children),i(this.children)},this.removeChild=function(t){for(var e=0;e<this.children.length;e++){var o=this.children[e];o.index==t&&(this.children.splice(e,1),n(o))}i(this.children)},this.lastChild=function(){return this.isLeaf()?null:this.children[this.children.length-1]},this.lastChildLeaf=function(t){var e=t||this.lastChild();return e.isLeaf()?e:this.lastChildLeaf(e.lastChild())},this.showCell=function(t){this.hidden[t]=!1,o()(this.list[t]).show()},this.hideCell=function(t){this.hidden[t]=!0,o()(this.list[t]).hide()}},e}};h.use(u,a);var c={name:"grid.base",component:function(){const t=h.include("util.base"),e=h.include("grid.column"),n=h.include("grid.row");return function(i,s){var r=this,l=i.$obj,h=i.$tpl,u=[],a=[],c={},d=!1,f=t.index();function p(){var t=[];l.thead.find("tr:last > th").each(function(e){t.push(this)});for(var n=0;n<t.length;n++){var i=new e(n);u[n]?(i.element=u[n].element,i.order=u[n].order,i.name=u[n].name,i.data=u[n].data,i.list=u[n].list,i.type=u[n].type,i.width=u[n].width):(i.element=t[n],(o()(i.element).attr("width")||o()(i.element).attr("style")&&-1!=o()(i.element).attr("style").indexOf("width"))&&(i.width=o()(i.element).outerWidth()),s&&s[n]&&(i.name=s[n]));for(var r=0;r<a.length;r++)i.list.push(a[r].list[n]),i.data.push(a[r].data[i.name]);u[n]=i}}function m(t,e){if("reload"==t||"append"==t)for(var n=0;n<u.length;n++)u[n].list[e.index]=e.list[n],u[n].data[e.index]=e.data[u[n].name];else if("remove"==t)for(n=0;n<u.length;n++)u[n].list.splice(e.index,1),u[n].data.splice(e.index,1);else p()}function v(t,e,i){if(t instanceof n)return t;var o=new n;return o.init(t,h.row,i),o.setIndex(e),o.reload(u),o}function g(t,e){var n=e.children;if(n.length>0)for(var i=0;i<n.length;i++)t.push(n[i]),n[i].children.length>0&&g(t,n[i])}function w(){var t=arguments[0],e=arguments[1];"function"==typeof t?(e=t,t=0):t=isNaN(t)?0:t;for(var n=t;n<a.length;n++)a[n].setIndex(n),a[n].reload(),m("reload",a[n]),"function"==typeof e&&e(n)}function C(){return"function"==typeof h.none&&(d?a.length>0&&(l.tbody.find("tr:first").remove(),d=!1):0==a.length&&(l.tbody.html(h.none()),d=!0),!0)}function y(t){for(var e=0,n=a.length;e<n;e++)if(a[e].index==""+t)return a[e];return null}this.appendRow=function(){var t=arguments[0],e=arguments[1],n=null;return n=e?function(t,e){var n=r.getRow(t),i=v(e,n.children.length,n);return n.appendChild(i),i}(t,e):function(t){var e=v(t,a.length);return a.push(e),l.tbody.append(e.element),m("append",e),e}(t),C(),n},this.insertRow=function(t,e){var n=null;return n=f.isIndexDepth(t)?function(t,e){var n=f.getIndexList(t),i=r.getRowParent(t),o=n[n.length-1],s=v(e,o,i);return i.insertChild(o,s),s}(t,e):0==a.length&&0==parseInt(t)?this.appendRow(e):function(t,e){var n=v(e,t),i=n;if(a.length!=t||0==t&&1==a.length)o()(n.element).insertBefore(a[t].element);else{var s=a[t-1];o()(n.element).insertAfter(0==s.children.length?s.element:s.lastChildLeaf().element)}return(i=a.splice(0,t)).push(n),a=i.concat(a),w(t),n}(t,e),C(),n},this.updateRow=function(t,e){var n=this.getRow(t);for(var i in e)n.data[i]=e[i];return n.reload(),m("reload",n),n},this.moveRow=function(e,n){if(e!=n){var i=this.getRowAll(e),o=i[0],s=t.clone(o.data);if(i.length>1)for(var r=0;r<i.length;r++)e=f.changeIndex(i[r].index,n,i[0].index),this.insertRow(e,i[r].data);else this.insertRow(n,s);this.removeRow(o.index)}},this.removeRow=function(t){var e=this.getRow(t);f.isIndexDepth(t)?e.destroy():(e.destroy(),m("remove",a[t]),a.splice(t,1),w(t)),C()},this.openRow=function(t){for(var e in this.getRow(t).open(),c[t]=!1,c)if(!1!==c[e]){var n=this.getRow(c[e]);null!=n&&n.fold()}},this.openRowAll=function(){for(var t=this.getRowAll(),e=0;e<t.length;e++)t[e].isLeaf()||(t[e].open(),c[t[e].index]=!1)},this.foldRow=function(t){this.getRow(t).fold(),c[t]=t},this.foldRowAll=function(){for(var t=this.getRowAll(),e=0;e<t.length;e++)t[e].isLeaf()||(t[e].fold(),c[t[e].index]=t[e].index)},this.removeRows=function(){a=[],C()||l.tbody.html(""),m()},this.sortRows=function(e,n){var i=t.sort(a);function o(t){var n=t.data[e];return"string"==typeof n?n.toLowerCase():isNaN(n)||null==n?"":n}n?i.setCompare(function(t,e){return o(t)>o(e)}):i.setCompare(function(t,e){return o(t)<o(e)}),i.run(),l.tbody.html(""),w(function(t){l.tbody.append(a[t].element)})},this.appendColumn=function(t,e){var n=u.length,i=o()(h[t]({rows:e})),s=i.filter("thead").find("tr");s.each(function(t){var e=l.thead.find("tr").eq(t);o()(this).find("th").each(function(n){e.append(this),s.size()-1==t&&u.push({element:this,list:[]})})});for(var r=0;r<a.length;r++)i.filter("tbody").find("tr").eq(r).find("td").each(function(t){o()(a[r].element).append(this),u[n+t].list.push(this),a[r].list.push(this),o.a.extend(a[r].data,e[r])})},this.removeColumn=function(t){for(var e=0;e<u[t].list.length;e++)o()(u[t].element).remove(),o()(u[t].list[e]).remove();for(var n=0;n<a.length;n++)a[n].list.splice(t,1);u.splice(t,1)},this.hideColumn=function(t){if("hide"!=u[t].type){for(var e=this.getRowAll(),n=0;n<e.length;n++)e[n].hideCell(t);u[t].hide()}},this.showColumn=function(t){if("show"!=u[t].type){for(var e=this.getRowAll(),n=0;n<e.length;n++)e[n].showCell(t);u[t].show()}},this.getColumnCount=function(){return u.length},this.getRowCount=function(){return a.length},this.getColumn=function(t){return null==t?u:u[t]},this.getRow=function(t){if(null==t)return a;if(n=y(t))return n;for(var e=f.getIndexList(t),n=y(e[0]),i=1,o=e.length;i<o&&n;i++)n=n.children[e[i]];return n},this.getRowAll=function(t){for(var e=[],n=null==t?a:[this.getRow(t)],i=0;i<n.length;i++)n[i]&&(e.push(n[i]),n[i].children.length>0&&g(e,n[i]));return e},this.getRowParent=function(t){return f.isIndexDepth(t)?this.getRow(f.getParentIndex(t)):null},this.setColumn=function(t,e){u[t]=e},this.setRow=function(t,e){a[t]=e},this.printInfo=function(){console.log(u),console.log(a)},C(),p()}}},d={name:"event",extend:"core",component:function(){var t=r.a.include("util.base"),e=r.a.include("manager"),n=r.a.include("collection"),i=function(){var t=null;this.find=function(t){return o()(this.root).find(t)},this.addEvent=function(){this.listen.add(arguments)},this.addTrigger=function(t,e){this.listen.trigger(t,e)},this.setVo=function(){this.options.vo&&(null!=t&&t.reload(),t=o()(this.selector).jbinder(),this.bind=t)},this.destroy=function(){for(var t=0;t<this.listen.size();t++){var e=this.listen.get(t);o()(e.target).off(e.type)}if(this.__proto__)for(var n in this.__proto__)delete this.__proto__[n]}};return i.build=function(i){return function(s,l){var h=[],u=o()(s||"<div />");return u.each(function(e){h[e]=r.a.createUIObject(i,u.selector,e,this,l,function(e,n){e.init.prototype.listen=new function(){var e=[];function n(t){for(var n=["webkit","moz","MS","o",""],i=0;i<n.length;i++){var s=t.type;n[i]||(s=s.toLowerCase()),o()(t.target).on(n[i]+s,t.callback)}e.push(t)}function i(t){t.callback&&!t.children?o()(t.target).on(t.type,t.callback):o()(t.target).on(t.type,t.children,t.callback),e.push(t)}function s(t){t.callback&&!t.children?o()(t.target).on(r(t.type),t.callback):o()(t.target).on(r(t.type),t.children,t.callback),e.push(t)}function r(t){return{click:"touchstart",dblclick:"touchend",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}[t]}this.add=function(e){var r={target:e[0],type:e[1]};t.typeCheck("function",e[2])?r=o.a.extend(r,{callback:e[2]}):t.typeCheck("string",e[2])&&(r=o.a.extend(r,{children:e[2],callback:e[3]}));for(var l=t.typeCheck("array",r.type)?r.type:[r.type],h=0;h<l.length;h++)r.type=l[h],-1!=r.type.toLowerCase().indexOf("animation")?n(r):("body"!=r.target&&r.target!=window&&r.target!=document&&o()(r.target).off(r.type),t.isTouch?s(r):i(r))},this.trigger=function(e,n){o()(e).trigger(t.isTouch?r(n):n)},this.get=function(t){return e[t]},this.getAll=function(){return e},this.size=function(){return e.length}},o()("script").each(function(t){if(s==o()(this).data("jui")||s==o()(this).data("vo")||s instanceof HTMLElement){var e=o()(this).data("tpl");if(""==e)throw new Error("JUI_CRITICAL_ERR: 'data-tpl' property is required");n.tpl[e]=o()(this).html()}})})}),e.add(new n(i.type,s,l,h)),0==h.length?null:1==h.length?h[0]:h}},i.init=function(t){var n=null;return"object"==typeof t&&(n=i.build(t),e.addClass({type:t.type,class:n})),n},i.setup=function(){return{vo:null}},i}};r.a.redefine("jquery",[],function(){return o.a}),r.a.use(d);var f=r.a,p={name:"ui.dropdown",extend:"event",component:function(){f.include("util.base");var t=function(){var t=e();null!=t&&t.hide()},e=function(){for(var t=f.get("ui.dropdown"),e=0;e<t.length;e++)for(var n=t[e],i=0;i<n.length;i++)if("show"==n[i].type)return n[i];return null};o()(function(){document.addEventListener("click",function(e){var n=e.target.tagName;"LI"!=n&&"INPUT"!=n&&"A"!=n&&"BUTTON"!=n&&"I"!=n&&t()}),window.addEventListener("keydown",function(t){var n=e();null!=n&&n.wheel(t.which,function(){t.preventDefault()})})});var n=function(){var e=null,n=-1;function i(n){var i=o()(e.menu).find("li");i.off("click").off("hover"),n.addEvent(i,"click",function(e){if(!(o()(this).hasClass("divider")||o()(this).hasClass("title")||o()(this).hasClass("disabled"))){var s=function(t){var e=0;return i.each(function(n){t==this&&(e=n)}),e}(this),r=o()(this).text(),l=o()(this).attr("value");n.emit("change",[{index:s,value:l,text:r},e]),n.options.close&&t(),"A"==e.target.tagName&&e.preventDefault()}}),n.addEvent(i,"hover",function(t){i.removeClass("active")})}function s(t,i){var o=e.menu.find("li"),s=o.eq(n);o.removeClass("active"),""!=s.val()||""!=s.html()?(s.addClass("active"),t.options.height>0&&e.menu.scrollTop(n*s.outerHeight())):"function"==typeof i&&i()}this.init=function(){var t=this.options,n=o()(this.root),s=n.find("ul"),r=n.find(".anchor");s=0==s.length?n:s,(e={root:n,menu:s,anchor:r}).root.outerWidth(e.menu.outerWidth()),t.width>0&&s.outerWidth(t.width),t.height>0&&s.css({maxHeight:t.height,overflow:"auto"}),t.left>0&&n.css("left",t.left),t.top>0&&n.css("top",t.top),s.css({display:"block"}),n.css({position:"absolute",display:"none"}),t.nodes.length>0?this.update(t.nodes):i(this),this.type="hide"},this.update=function(t){if(this.tpl.node){o()(e.menu).empty();for(var n=0;n<t.length;n++)o()(e.menu).append(this.tpl.node(t[n]));i(this)}},this.hide=function(){e.root.hide(),this.emit("hide"),this.type="hide"},this.show=function(n,i){t(),e.root.show(),e.anchor.length>0&&e.root.css("margin-top","10px"),2==arguments.length&&this.move(n,i),this.emit("show"),this.type="show"},this.move=function(t,n){e.root.css("left",t),e.root.css("top",n)},this.wheel=function(t,i){if(this.options.keydown){var o=this,r=e.menu.find("li");9!=t?(38!=t&&-1!=t||(n<1?n=r.length-1:n--,s(this,function(){n--,s(o)}),i&&i()),40!=t&&1!=t||(n<r.length-1?n++:n=0,s(o,function(){n++,s(o)}),i&&i()),13!=t&&0!=t&&t||(o.addTrigger(r.eq(n),"click"),n=-1,i&&i())):this.hide()}},this.reload=function(){this.init(),this.emit("reload")}};return n.setup=function(){return{close:!0,keydown:!1,left:0,top:0,width:0,height:0,nodes:[]}},n}};h.use(c,p);var m={name:"grid.table",extend:"event",component:function(){const t=h.include("util.base"),e=h.include("ui.dropdown"),n=h.include("grid.base"),i=h.include("grid.row");t.resize(function(){for(var t=h.get("grid.table"),e=0;e<t.length;e++)for(var n=t[e],i=0;i<n.length;i++)n[i].resize()},1e3);var s=function(){var s=null,r=null,l=null,h=null,u=null,a=null,c={},d=!1;function f(t,e){for(var n=[],i=0;i<e.length;i++)if("string"==typeof e[i]){var o=t.getColumn(e[i]);n.push(o.index)}else n.push(e[i]);return n}function p(t){var e=t.options.colshow,n=t.uit.getColumnCount();if(!0===e){t.options.colshow=e=[];for(var i=0;i<n;i++)e.push(i)}else e=f(t,e);for(i=0;i<n;i++)-1==o.a.inArray(i,e)?t.uit.hideColumn(i):t.uit.showColumn(i)}function m(t,e){t.uit.getRowCount()<1||(e&&(t.options.expand&&s.tbody.prepend(function(t){return"<tr class='expand' style='display: none;'><td id='EXPAND_"+t.timestamp+"'></td></tr>"}(t)),t.scroll()),t.options.scroll&&function(t){o()(t.root).hasClass("table-scroll")||t.scroll(),s.tbody.off("scroll").scroll(function(e){if(s.tbody.scrollTop()+t.options.scrollHeight==s.tbody.get(0).scrollHeight)return t.emit("scroll",e),!1})}(t),t.setVo())}function v(t,e){e=e||t.uit.getRow();for(var n=0;n<e.length;n++)!function(e){null!=e.element&&(e.children.length>0?(g(t,e),v(t,e.children)):g(t,e))}(e[n])}function g(t,e){if(t.addEvent(e.element,"click",function(n){if(t.emit("select",[e,n]),t.emit("click",[e,n]),t.options.expand){if(!1===t.options.expandEvent)return;(a instanceof i?a:t.get(a))===e?t.hideExpand(n):(null!=a&&t.hideExpand(n),t.showExpand(e,void 0,n))}}),t.addEvent(e.element,"dblclick",function(n){t.emit("dblclick",[e,n])}),t.addEvent(e.element,"contextmenu",function(n){return t.emit("rowmenu",[e,n]),!1}),t.options.editRow&&t.options.editEvent&&t.addEvent(e.element,"dblclick",function(n){"TD"!=n.target.tagName&&"TR"!=n.target.tagName||t.showEditRow(e.index,n)}),t.options.moveRow){function n(){return o()("<tr class='dragline'><td colspan='"+e.list.length+"'></td></tr>")}function r(e,n){if(s.tbody.find(".dragline").remove(),null!=u){if(o()("#TABLE_LAYER_"+t.timestamp).remove(),u!=e&&!1!==t.emit("move",[t.get(u),n])){t.move(u,e);var i=t.get(u<e?e-1:e);o()(i.element).addClass("dragtarget"),t.hideExpand(n),t.emit("moveend",[i,n])}u=null}}t.addEvent(e.element,"mousedown",function(n){null==u&&(u=e.index,s.tbody.find("tr").removeClass("dragtarget"),o()(e.element).addClass("dragtarget"),o()("body").append(function(e){var n=o()("<table id='TABLE_LAYER_"+t.timestamp+"' class='"+o()(t.root).attr("class")+" layer'></table>"),i=o()(e).clone();return n.css({position:"absolute",width:o()(t.root).width(),display:"none"}),i.attr({class:"dragclone"}),n.append(i),n}(e.element)))}),t.addEvent(e.element,"mouseover",function(t){null!=u&&(s.tbody.find(".dragline").remove(),n().insertBefore(e.element))}),t.addEvent(document,"mouseover",function(t){null!=u&&"TD"!=t.target.tagName&&"TR"!=t.target.tagName&&(s.tbody.find(".dragline").remove(),s.tbody.append(n()))}),t.addEvent(e.element,"mousemove",function(e){null!=u&&o()("#TABLE_LAYER_"+t.timestamp).css({left:e.pageX+2,top:e.pageY+2,display:"table"})}),t.addEvent(e.element,"mouseup",function(t){r(e.index,t)}),t.addEvent(s.thead,"mouseover",function(t){r(0,t)}),t.addEvent(document,"mouseup",function(e){r(t.count(),e)})}}function w(t){var e=0,n=s.table.offset(),i=null,r=null,l=0,h=0,u=null;s.thead.find(".resize").remove();for(var a=0;a<t.uit.getColumnCount()-1;a++){var c=o()(t.getColumn(a).element),f=o()("<div class='resize'></div>"),p=c.offset();f.css({position:"absolute",width:"8px",height:c.outerHeight(),left:c.outerWidth()+(p.left-n.left)-1+"px",top:p.top-n.top+"px",cursor:"w-resize","z-index":"1"}),c.append(f),function(n){t.addEvent(f,"mousedown",function(s){return 0==e&&(e=s.pageX),i=t.getColumn(n),r=m(n),l=o()(i.element).outerWidth(),h=o()(r.element).outerWidth(),u=this,d=!0,!1})}(a)}function m(e){for(var n=e+1;n<t.uit.getColumnCount();n++){var i=t.getColumn(n).element;if(!o()(i).is(":hidden"))return t.getColumn(n)}}t.addEvent(document,"mousemove",function(n){e>0&&function(t,e){if(l+e<30||h-e<30)return;if(o()(i.element).outerWidth(l+e),o()(r.element).outerWidth(h-e),t.options.scroll){var n=o()(r.element).outerWidth()-(i.index==t.uit.getColumnCount()-2?y():0);o()(i.list[0]).outerWidth(o()(i.element).outerWidth()),o()(r.list[0]).outerWidth(n)}}(t,n.pageX-e)}),t.addEvent(document,"mouseup",function(s){if(e>0){e=0;var r=o()(i.element).offset().left-n.left;return o()(u).css("left",o()(i.element).outerWidth()+r-1),t.emit("colresize",[i,s]),setTimeout(function(){d=!1},100),!1}})}function C(t,e){t.hideExpand(),t.hideEditRow(),t.unselect(),e||t.uncheckAll()}function y(){return null!=o()(".jui")&&t.browser.webkit?10:t.scrollWidth()}this.init=function(){var t=this.options;if(t.data=null!=t.rows?t.rows:t.data,s={table:o()(this.root).css({position:"relative"}),thead:o()(this.root).find("thead"),tbody:o()(this.root).find("tbody")},this.uit=new n({$obj:s,$tpl:this.tpl},t.fields),t.moveRow&&s.tbody.css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none"}),t.fields&&t.colshow&&p(this),t.fields&&this.tpl.menu&&null!=e&&function(t){for(var n=t.listColumn(),i=[],s=0;s<n.length;s++)i.push(o()(n[s].element).text());var l=o()(t.tpl.menu({columns:i}));o()("body").append(l),r=e(l,{close:!1}),o()(r.root).find("input[type=checkbox]").each(function(e){"show"==n[e].type?this.checked=!0:this.checked=!1,t.addEvent(this,"click",function(n){var i=null!=o()(r.root).find("input[type=checkbox]:checked");this.checked?t.showColumn(e,n):i?t.hideColumn(e,n):this.checked=!0,t.hideExpand(),t.scroll()})})}(this),t.resize&&w(this),t.fields&&t.sort&&!0===t.sortEvent&&function(t){for(var e=t.options.sort,n=!0===e?t.uit.getColumnCount():e.length,i=0;i<n;i++){var s=!0===e?i:e[i],r=t.getColumn(s);null!=r.element&&(function(e,n){t.addEvent(n.element,"click",function(i){o()(i.target).hasClass("resize")||(t.sort(e,void 0,i),t.emit("colclick",[n,i]))})}(s,r),o()(r.element).css("cursor","pointer"))}}(this),t.data.length>0?this.update(t.data):this.setVo(),t.width>0&&s.table.outerWidth(t.width),!t.fields&&(t.sort||t.colshow||t.editRow))throw new Error("JUI_CRITICAL_ERR: 'fields' option is required");!function(t){for(var e=t.options,n=t.uit.getColumnCount(),i=0;i<n;i++)!function(n,i){e.fields&&e.sort&&!0===e.sortEvent||t.addEvent(i.element,"click",function(e){t.emit("colclick",[i,e])}),t.addEvent(i.element,"dblclick",function(e){t.emit("coldblclick",[i,e])}),t.addEvent(i.element,"contextmenu",function(e){return t.emit("colmenu",[i,e]),!1})}(0,t.getColumn(i))}(this)},this.update=function(){var t=1==arguments.length?arguments[0]:arguments[1],e=2==arguments.length?arguments[0]:null;null!=e?(g(this,this.uit.updateRow(e,t)),0==parseInt(e)&&this.scroll()):(this.uit.removeRows(),this.scroll(),this.append(t),this.options.sortIndex&&this.sort(this.options.sortIndex,this.options.sortOrder,null))},this.updateTree=function(e){var n=t.index();this.uit.removeRows();for(var i=0;i<e.length;i++){var o=n.getParentIndex(e[i].index);null==o?this.uit.appendRow(e[i].data):this.uit.appendRow(o,e[i].data)}m(this,!0),v(this)},this.append=function(){var t=!(this.count()>0),e=1==arguments.length?arguments[0]:arguments[1],n=2==arguments.length?arguments[0]:null;e=void 0==e.length?[e]:e;for(var i=0;i<e.length;i++){var o=null;o=null!=n?this.uit.appendRow(n,e[i]):this.uit.appendRow(e[i]),t||g(this,o)}m(this,t),t&&v(this)},this.insert=function(t,e){for(var n=!(this.count()>0),i=(e=void 0==e.length?[e]:e,0);i<e.length;i++)this.uit.insertRow(t,e[i]);m(this,n),v(this)},this.select=function(t){C(this);var e=this.get(t);return o()(e.element).parent().find(".selected").removeClass("selected"),o()(e.element).addClass("selected"),l=t,e},this.unselect=function(){if(null!=l){var t=this.get(l);return o()(t.element).removeClass("selected"),l=null,t}},this.check=function(t){C(this,!0);var e=this.get(t);this.hideExpand(),this.hideEditRow(),this.unselect(),c[t]=e,o()(e.element).addClass("checked")},this.uncheck=function(t){if(null!=c[t]){var e=this.get(t);c[t]=null,o()(e.element).removeClass("checked")}},this.uncheckAll=function(){c={},s.tbody.find(".checked").removeClass("checked")},this.remove=function(t){if(null==t)return null;this.uit.removeRow(t),v(this),this.scroll()},this.reset=function(){l=null,a=null,h=null,u=null,c={},this.uit.removeRows(),this.scroll()},this.move=function(t,e){this.uit.moveRow(t,e),v(this),0!=parseInt(t)&&0!=parseInt(e)||this.scroll()},this.sort=function(t,e,n){if(this.options.fields&&this.options.sort&&!d){var i=this.getColumn(t);"string"==typeof i.name&&(i.order=e||("asc"==i.order||null==i.order?"desc":"asc"),this.uit.setColumn(t,i),this.uit.sortRows(i.name,"desc"==i.order),this.emit("sort",[i,n]),m(this,!0),v(this))}},this.scroll=function(t){if(this.options.scroll){var e=this,n=(n=t&&t>0?t:this.options.scrollHeight)>0?n:200;this.options.scrollHeight=n,s.tbody.css("maxHeight",n+"px"),setTimeout(function(){s.tbody.outerHeight()<n?(s.table.css({"table-layout":""}),s.tbody.css({display:"",overflow:""})):(s.table.css({"table-layout":"fixed"}),s.tbody.css({display:"block",overflow:"auto"})),function(t){for(var e=s.table.outerWidth(),n=!1,i=t.uit.getColumnCount()-1;i>=0;i--){var r=t.getColumn(i),l=o()(r.element).outerWidth();"none"==o()(r.element).css("display")||n||(l-=y(),n=!0),o()(r.list[0]).outerWidth(l)}s.tbody.outerWidth(e)}(e)},10)}},this.open=function(t){null!=t&&(this.uit.openRow(t),this.emit("open",[this.get(t)]))},this.fold=function(t){null!=t&&(this.uit.foldRow(t),this.emit("fold",[this.get(t)]))},this.openAll=function(){this.uit.openRowAll(),this.emit("openall")},this.foldAll=function(){this.uit.foldRowAll(),this.emit("foldall")},this.resize=function(){this.scroll(),this.options.resize&&w(this)},this.resizeColumns=function(){for(var t=this.listColumn(),e=0;e<t.length;e++)null==t[e].width&&o()(t[e].element).outerWidth("auto")},this.size=function(){return this.uit.getRowCount()},this.count=function(){return this.uit.getRowCount()},this.list=function(){return this.uit.getRow()},this.listData=function(){for(var t=this.list(),e=[],n=0;n<t.length;n++)e.push(t[n].data);return e},this.listAll=function(){return this.uit.getRowAll()},this.listChecked=function(){var t=[];for(var e in c)null!=c[e]&&t.push(c[e]);return t},this.listColumn=function(){return this.uit.getColumn()},this.get=function(t){return null==t?null:this.uit.getRow(t)},this.getAll=function(t){return null==t?null:this.uit.getRowAll(t)},this.getColumn=function(t){return null==t?null:"string"==typeof t?this.uit.getColumn(o.a.inArray(t,this.options.fields)):this.uit.getColumn(t)},this.showColumn=function(t,e){if(this.options.fields){var n=this.getColumn(t);this.uit.showColumn(n.index),this.scroll(),this.resizeColumns(),this.options.resize&&w(this),this.emit("colshow",[n,e])}},this.hideColumn=function(t,e){if(this.options.fields){var n=this.getColumn(t);this.uit.hideColumn(n.index),this.scroll(),this.resizeColumns(),this.options.resize&&w(this),this.emit("colhide",[n,e])}},this.initColumns=function(t){"object"==typeof t&&(this.options.colshow=t,p(this),this.scroll(),this.resizeColumns(),this.options.resize&&w(this))},this.showColumnMenu=function(e,n){if(this.options.fields&&r){var i=this.listColumn(),l=s.thead.offset(),h=t.typeCheck("integer",e)?e:0,u=t.typeCheck("integer",n)?n:l.top+s.thead.outerHeight();o()(r.root).find("input[type=checkbox]").each(function(t){"show"==i[t].type?this.checked=!0:this.checked=!1}),r.move(h,u),r.show()}},this.hideColumnMenu=function(){this.options.fields&&r&&r.hide()},this.toggleColumnMenu=function(t,e){this.options.fields&&r&&("show"==r.type?this.hideColumnMenu():this.showColumnMenu(t,e))},this.showExpand=function(t,e,n){if(this.options.expand){C(this);var r="#EXPAND_"+this.timestamp,l=t instanceof i?t:this.get(t),h=(e="object"!=typeof e?o.a.extend({row:l},l.data):e,o()(r).parent().show());s.tbody.find("tr").removeClass("open"),h.insertAfter(o()(l.element).addClass("open")),o()(r).attr("colspan",s.thead.find("tr:last > th:visible").length).html(this.tpl.expand(e)),this.scroll(),this.setVo(),a=t,this.emit("expand",[l,n])}},this.hideExpand=function(t){if(null!=a){var e=a instanceof i?a:this.get(a);o()("#EXPAND_"+this.timestamp).parent().hide(),s.tbody.find("tr").removeClass("open"),this.scroll(),a=null,this.emit("expandend",[e,t])}},this.getExpand=function(){return null==a?null:a instanceof i?a:this.get(a)},this.showEditRow=function(t,e){if(this.options.editRow){C(this);var n=this,i=this.get(t),r=o()(i.element).find("td");r.each(function(t){!function(t,e,n,i,r,l){var u=t.getColumn(i),a=t.options.editRow,c=null;function d(){null!=h&&l()}!u.name||!0!==a&&-1==o.a.inArray(i,f(t,a))?(c=o()("<div class='edit'></div>").html(o()(e).html()||"&nbsp;")).attr("disabled",!0):c=o()("<input type='text' class='edit' />").val(u.name?u.data[n.index]:""),o()(e).html(c.css("width","100%")),r&&r.target==e&&c.focus(),t.addEvent(c,"keypress",function(t){13==t.which&&d()}),t.addEvent(s.tbody,"mousedown",function(t){"TD"!=t.target.tagName&&"TR"!=t.target.tagName||d()})}(n,this,i,t,e,function(){var t={},s=i.data;r.each(function(e){var i=n.getColumn(e);if(null!=i.name){var s=o()(this).find("input.edit");if(1==s.length){var r=s.val();t[i.name]=isNaN(r)||null==r||""==r?r:parseFloat(r)}}}),i.data=o.a.extend(i.data,t),!1!==n.emit("editend",[i,e])?n.hideEditRow(t):i.data=s})}),h=t,n.emit("editstart",[i,e])}},this.hideEditRow=function(t){if(null!=h){var e=this.get(h);h=null,this.update(e.index,t||e.data)}},this.getEditRow=function(){return null==h?null:this.get(h)},this.setCsv=function(){var e=this.options;if(e.fields||e.csv){var n=1==arguments.length?arguments[0]:arguments[1],i=2==arguments.length?arguments[0]:null,o=t.getCsvFields(e.fields,e.csv),s=e.csvNumber?t.getCsvFields(e.fields,e.csvNumber):null,r=t.csvToData(o,n,s);if(null==i)this.update(r);else{this.reset();for(var l=0;l<r.length;l++){var h=r[l][i];h&&this.insert(h,r[l])}}}},this.setCsvFile=function(){if(this.options.fields||this.options.csv){var e=this,n=1==arguments.length?arguments[0]:arguments[1],i=2==arguments.length?arguments[0]:null;t.fileToCsv(n,function(t){null==i?e.setCsv(t):e.setCsv(i,t)})}},this.getCsv=function(e){if(this.options.fields||this.options.csv){for(var n=t.getCsvFields(this.options.fields,this.options.csv),i=[],o=e?this.listAll():this.list(),s=0;s<o.length;s++)i.push(o[s].data);return t.dataToCsv2({fields:n,rows:i,names:this.options.csvNames})}},this.getCsvBase64=function(e){if(this.options.fields||this.options.csv)return t.csvToBase64(this.getCsv(e))},this.downloadCsv=function(e,n){t.typeCheck("string",e)&&(e=e.split(".")[0]);var i=document.createElement("a");i.download=e?e+".csv":"table.csv",i.href=this.getCsvBase64(n),document.body.appendChild(i),i.click(),i.parentNode.removeChild(i)},this.activeIndex=function(){return null!=a?a instanceof i?a.index:a:l||h}};return s.setup=function(){return{fields:null,csv:null,csvNames:null,csvNumber:null,data:[],rows:null,colshow:!1,scroll:!1,scrollHeight:200,width:0,expand:!1,expandEvent:!0,editRow:!1,editEvent:!0,resize:!1,sort:!1,sortIndex:null,sortOrder:"asc",sortEvent:!0,moveRow:!1,animate:!1}},s}},v={name:"ui.modal",extend:"event",component:function(){var t=0,e=0;f.include("util.base").resize(function(){if(t!=o()(window).width()||e!=o()(window).height()){for(var n=f.get("ui.modal"),i=0;i<n.length;i++)for(var s=n[i],r=0;r<s.length;r++)"show"==s[r].type&&s[r].resize();t=o()(window).width(),e=o()(window).height()}},300);var n=function(){var t={},e=null,n=null,i=null,s=5e3;function r(t){var e,n=t.options.target,i="body"==n?window:n,s="body"==n?"fixed":"absolute",r=function(t){return"body"==t?null:o()(t).hasClass("msgbox")||o()(t).hasClass("window")?"absolute":"relative"}(n),l=o()(n).scrollLeft(),h=o()(i).width()/2-o()(t.root).width()/2+o()(n).scrollLeft(),u=o()(i).height()/2-o()(t.root).height()/2,a=l>0?o()(n).outerWidth()+l:"100%",c=o()(n).outerHeight();null!=r?(c=(e=o()(i)[0].scrollHeight)>c?e:c,u+=o()(i).scrollTop()):c=c>(e=o()(window).outerHeight())?c:e;return{x:h,y:u,pos:s,tPos:r,w:a,h:c}}this.init=function(){!function(t){n={position:o()(t.root).css("position"),left:o()(t.root).css("left"),top:o()(t.root).css("top"),"z-index":o()(t.root).css("z-index"),display:o()(t.root).css("display")},i={position:o()(t.options.target).css("position")}}(this),this.options.clone||o()(this.root).hide(),this.type="hide"},this.hide=function(){var s=this.options,r=this.timestamp;s.clone&&(e.remove(),e=null),o()(s.target).css("position",i.position),o()(this.root).css(n),t[r]&&(t[r].remove(),delete t[r]),this.type="hide"},this.show=function(){var n=this.options,i=r(this);n.clone&&(e=o()(this.root).clone()).insertAfter(o()(this.root)),o()(this.root).appendTo(n.target),this.resize(),o()(n.target).css("position",i.tPos),o()(this.root).show(),function(e,n,i){var r=e.options,l=e.timestamp,h=null!=r.parent?r.parent:r.target;null==t[l]&&(t[l]=o()("<div id='MODAL_"+e.timestamp+"'></div>").css({position:"absolute",width:n,height:i,left:0,top:0,opacity:e.options.opacity,"background-color":e.options.color,"z-index":s+e.options.index-1}),o()(h).append(t[l]),o()(e.root).insertAfter(t[l]),e.addEvent(t[l],"click",function(t){return e.options.autoHide&&e.hide(),!1}))}(this,i.w,i.h),this.type="show"},this.resize=function(){var e=r(this),n=this.timestamp;o()(this.root).css({position:e.pos,left:e.x,top:e.y,"z-index":s+this.options.index}),null!=t[n]&&t[n].height(e.h)}};return n.setup=function(){return{color:"black",opacity:.4,target:"body",parent:null,index:0,clone:!1,autoHide:!0}},n}};h.use(m,p,v);var g={name:"grid.xtable",extend:"event",component:function(){const t=h.include("util.base"),e=h.include("ui.modal"),n=h.include("grid.table"),i=h.include("grid.row");t.resize(function(){for(var t=h.get("grid.xtable"),e=0;e<t.length;e++)for(var n=t[e],i=0;i<n.length;i++)n[i].resize()},1e3);var s=function(){var s=null,r=null,l=[],h=[],u=[],a=null,c=null,d=1,f=!1,p=!1,m=8,v=null,g=t.index(),w=null,C=null;function y(t,e,n,o){for(var r=[],l=0,u=t.length;l<u;l++){var a=new i,c=e+l;a.init(t[l],s.tpl.row,n),a.setIndex(c),"open"!=o&&"fold"!=o||(a.type=o),null==n&&(h[c]=a),r.push(a)}return r}function x(t,e,n){var i=t.options,s=!1,l=o()(t.root).children(".head"),h=o()(t.root).children(".body");t.addEvent(h,"scroll",function(u){(t.hideColumnMenu(),e>0&&l.scrollLeft(this.scrollLeft),"scroll"==i.buffer)?this.scrollTop+n>=.9*h.get(0).scrollHeight&&(t.next(),t.emit("scroll",u)):"vscroll"==i.buffer&&(w.prev_scroll_left==this.scrollLeft?s||(s=!0,setTimeout(function(){!function(t){var e=o()(t.root).children(".body"),n=t.options.scrollHeight,i=e.scrollTop(),s=e[0].scrollHeight,l=Math.abs(w.prev_scroll_top-i),h=w.prev_scroll_top<i,u=w.height;if(0==l)return;var a=!1;if(l<n){if(a=!0,0!==l){if(l<u)var c=Math.ceil(l/u);else var c=Math.floor(l/u);0==h?w.current_row_index-=c:w.current_row_index+=c}}else{var d=i/(s-n),f=Math.floor(w.count-w.scroll_count);w.current_row_index=Math.ceil(f*d)}var p=w.current_row_index,m=p,v=u;for(;v<n&&m<w.count;)m++,v+=u;if(v<n)if(n>w.content_height);else{var g=Math.ceil(Math.abs(n-v)/u);p-=g,v+=g*u}if(p<0)return void(w.prev_scroll_top=0);a&&m!==w.count-1&&(i=Math.ceil(p/w.count*s),e.scrollTop(i),i=e.scrollTop());var C=0,y=n+w.height;i>=s-y&&v>y&&(C=-Math.abs(v-y));w.prev_scroll_top=i,e.css({"max-height":v}),o()(r.root).css({top:w.prev_scroll_top+C+"px"}),w.start_index=p,w.end_index=m+1}(t),t.next(),t.emit("scroll",u),s=!1},1)):w.prev_scroll_left=this.scrollLeft);return!1}),"vscroll"==i.buffer&&(o()(t.root).hover(function(){w.is_focus=!0},function(){w.is_focus=!1}),t.addEvent(document,"keydown",function(e){if(w.is_focus){var n=h.scrollTop(),i=t.options.rowHeight;if(38==e.which||40==e.which)h.scrollTop(n+(38==e.which?-i:i));else if(33==e.which||34==e.which){var o=i*w.scroll_count;h.scrollTop(n+(33==e.which?-o:o))}}}))}function b(t){var e={},n={},i=0;o()(t.root).find("thead .resize").remove();for(var l=0,h=s.uit.getColumnCount();l<h;l++){var u=o()(s.getColumn(l).element),a=o()("<div class='resize'></div>"),c=u.position(),d=u.outerWidth()+c.left-1;a.css({position:"absolute",width:m+"px",height:u.outerHeight(),left:(l==h-1?d-m:d)+"px",top:c.top+"px",cursor:"w-resize","z-index":"1"}),u.append(a),function(l,h){t.addEvent(a,"mousedown",function(t){return 0==i&&(i=t.pageX),e={head:s.getColumn(l),body:r.getColumn(l),isLast:h},n={column:o()(e.head.element).outerWidth(),head:o()(s.root).outerWidth(),body:o()(r.root).outerWidth(),"max-width":parseInt(o()(s.root).parent().css("max-width"))},p=!0,!1})}(l,l==h-1)}t.addEvent(document,"mousemove",function(t){i>0&&function(t){if(n.head+t<n["max-width"])return;if(n.column+t<30)return;o()(e.head.element).outerWidth(n.column+t),o()(e.body.element).outerWidth(n.column+t),o()(s.root).outerWidth(n.head+t),o()(r.root).outerWidth(n.body+t)}(t.pageX-i)}),t.addEvent(document,"mouseup",function(t){if(i>0){if(e.isLast){var n=o()(r.root).parent().scrollLeft(),l=t.pageX-i;l>0&&(o()(s.root).parent().scrollLeft(n+l),o()(r.root).parent().scrollLeft(n+l))}return i=0,k(500),s.emit("colresize",[e.head,t]),setTimeout(function(){p=!1},100),!1}}),s.on("colshow",k),s.on("colhide",k)}function k(t){setTimeout(function(){for(var t=0,e=s.uit.getColumnCount();t<e;t++){var n=o()(s.getColumn(t).element),i=n.position(),r=n.outerWidth()+i.left-1;n.find(".resize").css("left",(t==e-1?r-m:r)+"px")}},t)}function _(e){return"page"==e.options.buffer?0:t.scrollWidth()+1}function R(e,n,i){for(var o=e.children.length,s=y(t.typeCheck("array",n)?n:[n],o,e,i),r=0,l=s.length;r<l;r++)e.children.push(s[r])}function E(t,e){e?(u=[],function t(e){for(var n=0;n<e.length;n++)u.push(e[n]),"open"==e[n].type&&e[n].children.length>0&&t(e[n].children)}(l)):u=l,"vscroll"==t.options.buffer&&function(t){w.height=t.options.rowHeight,w.count=u.length,w.scroll_count=Math.floor(t.options.scrollHeight/w.height),w.content_height=w.count*w.height,o()(r.root).parent().height(w.content_height>0?w.content_height:"auto")}(t)}function L(t,e,n,i,o){var s="desc"==i[o]?1:0,r=n[o],l=!isNaN(+t[r]-+e[r]),h=l?+t[r]:t[r],u=l?+e[r]:e[r];return l||("string"==typeof h&&(h=h.toLowerCase()),"string"==typeof u&&(u=u.toLowerCase())),h<u?0==s?-1:1:h==u?n.length-1>o?L(t,e,n,i,o+1):0:0==s?1:-1}this.init=function(){var i=this.options;if(i.data=null!=i.rows?i.rows:i.data,"TABLE"==this.root.tagName){var l=o()(this.root).wrap("<div class='xtable'></div>");this.root=l.parent().get(0)}if(function(t){var e=["buffer","bufferCount","csvCount","sortLoading","sortCache","sortIndex","sortOrder","event","rows","scrollWidth","width","rowHeight","xssFilter","msort"],i=o()(t.root);if("vscroll"==t.options.buffer&&(i.hasClass("nowrap")||i.addClass("nowrap")),"page"!=t.options.buffer&&(i.hasClass("scroll")||i.addClass("scroll")),i.append(i.children("table").clone()),function(t,e){o()(e.root).wrap("<div class='head'></div>"),o()(e.root).children("tbody").remove()}(0,s=n(i.children("table:first-child"),d(t,e))),function(t,e){var n=e.listColumn();if("page"!=t.options.buffer){var i=t.options.scrollHeight;"vscroll"==t.options.buffer?(o()(e.root).wrap("<div class='body' style='max-height: "+i+"px'><div></div></div>"),o()(e.root).parent().parent().css({"overflow-y":"scroll"})):(o()(e.root).wrap("<div class='body' style='max-height: "+i+"px'></div>"),o()(e.root).parent().css({"overflow-y":"scroll"}))}else o()(e.root).wrap("<div class='body'></div>");o()(e.root).find("thead > tr").outerHeight(0).not(":last-child").remove();for(var s=0;s<n.length;s++)o()(n[s].element).html("").outerHeight(0)}(t,r=n(i.children("table:last-child"),d(t,e.concat("resize")))),function(t,e,n){var i=t.options;i.scrollWidth>0?t.scrollWidth(i.scrollWidth,!0):i.width>0&&o()(t.root).outerWidth(i.width)}(t),t.options.xssFilter){var l=t.options.xssFilter,h=!0===l?s.uit.getColumnCount():l.length;C={};for(var u=0;u<h;u++){var a=!0===l?u:l[u],c=s.getColumn(a);C[c.name]=!0}}function d(t,e){var n={};for(var i in t.options)-1==o.a.inArray(i,e)&&(n[i]=t.options[i]);return t.options.scrollWidth>0&&(n.resize=!1),n}}(this),function(e){s.on("colresize",function(n,i){for(var l=s.listColumn(),h=r.listColumn(),u=!1,a=l.length-1;a>=0;a--){var c=o()(l[a].element).outerWidth();"page"==e.options.buffer||"show"!=l[a].type||u?(o()(l[a].element).outerWidth(c),o()(h[a].element).outerWidth(c)):(t.browser.msie?o()(h[a].element).outerWidth(c-_(e)):o()(h[a].element).css({width:"auto"}),u=!0)}k(500),e.emit("colresize",[n,i])}),s.on("colshow",function(t,n){r.uit.showColumn(t.index),e.resize(),e.emit("colshow",[t,n])}),s.on("colhide",function(t,n){r.uit.hideColumn(t.index),e.resize(),e.emit("colhide",[t,n])}),s.on("colclick",function(t,n){e.emit("colclick",[t,n])}),s.on("coldblclick",function(t,n){e.emit("coldblclick",[t,n])}),s.on("colmenu",function(t,n){e.emit("colmenu",[t,n])}),s.on("sort",function(t,n){e.sort(t.index,t.order,!1,n),e.emit("sort",[t,n])}),r.on("select",function(t,n){e.emit("select",[t,n])}),r.on("click",function(t,n){e.emit("click",[t,n])}),r.on("dblclick",function(t,n){e.emit("dblclick",[t,n])}),r.on("rowmenu",function(t,n){e.emit("rowmenu",[t,n])}),r.on("expand",function(t,n){e.emit("expand",[t,n])}),r.on("expandend",function(t,n){e.emit("expandend",[t,n])})}(this),x(this,i.scrollWidth,i.scrollHeight),i.msort&&i.sortEvent&&function(e){for(var n=e.options.msort,i=!0===n?s.uit.getColumnCount():n.length,r=[],l=[],h=0;h<i;h++){var u=!0===n?h:n[h],a=e.getColumn(u);null!=a.element&&(function(n,i){e.addEvent(i.element,"click",function(n){if(!o()(n.target).hasClass("resize")){if("asc"==i.order){i.order=null;for(var s=0;s<r.length;s++)i.name==r[s]&&(r.splice(s,1),l.splice(s,1))}else{var h=t.inArray(i.name,r);null==i.order?i.order="desc":"desc"==i.order&&(i.order="asc"),-1==h?(r.push(i.name),l.push(i.order)):l[h]=i.order}e.emit("msort",[i,n]),e.msort(r,l),e.emit("colclick",[i,n])}})}(0,a),o()(a.element).css("cursor","pointer"))}}(this),i.data&&this.update(i.data),s.tpl.loading&&null!=e){var h=o()(s.tpl.loading());o()(this.root).append(h),c=e(h,{target:this.selector,opacity:.1,autoHide:!1}),i.sortLoading=!0===i.sortLoading?500:i.sortLoading}i.resize&&(i.scrollWidth>0?b(this):(s.resizeColumns(),s.resize()))},this.render=function(t){E(this,t),this.next()},this.select=function(t){null!=v&&o()(v.element).removeClass("selected");var e=this.get(t);return v=e,null!=e.element&&o()(e.element).addClass("selected"),e},this.unselect=function(){null!=v&&(o()(v.element).removeClass("selected"),v=null)},this.update=function(t){this.reset(),l=y(t,0,null),this.render(),this.emit("update"),s.emit("colresize"),this.options.sortIndex&&(this.options.sort?this.sort(this.options.sortIndex,this.options.sortOrder,!0):this.options.msort&&this.msort(this.options.sortIndex,this.options.sortOrder,!0))},this.updateTree=function(t){this.reset();for(var e=0;e<t.length;e++){var n=g.getParentIndex(t[e].index);if(null==n)l.push(y([t[e].data],0,null,t[e].type)[0]);else{var i=this.get(n);i&&R(i,t[e].data,t[e].type)}}this.render(!0),this.emit("updateTree")},this.append=function(t,e){var n=this.get(t);n&&(R(n,e),this.clear(),this.render(!0),this.emit("append"))},this.open=function(t){var e=this.get(t);e&&(e.type="open",this.clear(),this.render(!0),this.emit("open",[e]))},this.fold=function(t){var e=this.get(t);e&&(e.type="fold",this.clear(),this.render(!0),this.emit("fold",[e]))},this.openAll=function(t){var e=[];if(this.findAll(t,e),e){for(var n=0,i=e.length;n<i;n++)e[n].type="open";this.clear(),this.render(!0),this.emit("openall")}},this.foldAll=function(t){var e=[];if(this.findAll(t,e),e){for(var n=0,i=e.length;n<i;n++)e[n].type="fold";this.clear(),this.render(!0),this.emit("foldall")}},this.next=function(){var t=(d-1)*this.options.bufferCount,e=t+this.options.bufferCount;if("vscroll"==this.options.buffer&&(r.reset(),w.start_index<w.end_index&&(t=w.start_index,e=w.end_index)),(e=e>u.length?u.length:e)<=u.length){for(var n=[],i=t;i<e;i++){var o=u[i];o.seq=i+1,o.reload(s.uit.getColumn(),null,C),n.push(o)}r.append(n),"vscroll"!=this.options.buffer&&(this.emit("next",[d]),n.length>0&&d++)}},this.page=function(t){return"scroll"!=this.options.buffer&&"vscroll"!=this.options.buffer&&(this.getPage()!=t&&(this.clear(),d=t<1?1:t,void this.render()))},this.sort=function(t,e,n,i){if(this.options.fields&&this.options.sort&&!this.options.msort&&!p){var o=this,r=s.getColumn(t);"string"==typeof r.name&&(r.order=e||("asc"==r.order||null==r.order?"desc":"asc"),s.uit.setColumn(t,r),this.options.sortLoading&&!n?(o.showLoading(),setTimeout(function(){h()},this.options.sortLoading)):h()),this.options.sortCache&&this.setOption({sortIndex:r.index,sortOrder:r.order})}function h(){l.sort(function(t,e){return L(t.data,e.data,[r.name],[r.order],0)}),o.clear(),o.render(!0),o.emit("sortend",[r,i]),o.hideLoading()}},this.msort=function(e,n,i){if(this.options.fields&&this.options.msort&&!this.options.sort&&t.typeCheck("array",e)&&t.typeCheck("array",n)&&e.length==n.length){null==a?a=u:u=a;var o=this,s=u.slice();this.options.sortLoading&&!i?(o.showLoading(),setTimeout(function(){r()},this.options.sortLoading)):r(),this.options.sortCache&&this.setOption({sortIndex:e,sortOrder:n})}function r(){e.length>0&&s.sort(function(t,i){return L(t.data,i.data,e,n,0)}),l=s,o.clear(),o.render(!0),o.emit("msortend"),o.hideLoading(),s=null}},this.filter=function(t){null==a?a=u:u=a;for(var e=u.slice(),n=[],i=0,o=e.length;i<o;i++){var s=e[i].data;("function"==typeof t&&!0===t(s)||!t)&&n.push(s)}this.update(n),this.emit("filter",[n]),e=null},this.rollback=function(){this.filter(null),a=null},this.clear=function(){d=1,r.uit.removeRows(),r.scroll()},this.reset=function(){"vscroll"==this.options.buffer&&function(t){o()(t.root).find(".body").scrollTop(0),o()(r.root).css({top:"0px"}),o()(r.root).parent().css({height:"auto"}),w={height:0,content_height:0,count:0,scroll_count:0,prev_scroll_left:0,prev_scroll_top:0,current_row_index:0,start_index:0,end_index:0,is_focus:!0}}(this),this.clear(),l=[],h=[],u=[],v=null},this.resize=function(){s.resizeColumns(),s.resize(),s.emit("colresize")},this.scrollWidth=function(t,e){if(0!=this.options.scrollWidth){var n=this.options.width;if(n>0){var i=t>=n?t-_(this):n;o()(this.root).outerWidth(i)}else o()(this.root).outerWidth(t-_(this));if(t>0){var l=o()(this.root).outerWidth();o()(this.root).outerWidth(t),e&&(o()(s.root).outerWidth(l+_(this)),o()(r.root).outerWidth(l),k(1e3)),o()(s.root).parent().css("max-width",t),o()(r.root).parent().css("max-width",t)}}},this.scrollHeight=function(t){"page"!=this.options.buffer&&(o()(this.root).find(".body").css("max-height",t+"px"),this.setOption("scrollHeight",t),x(this,this.options.scrollWidth,t))},this.scrollTop=function(e,n){if("vscroll"==this.options.buffer){var i=o()(this.root).children(".body");E(this,!0);for(var s=0,r=u.length;s<r;s++){if(""+e==u[s].index){var l=s*w.height,h=i.height(),a=t.typeCheck("integer",n)?n:0;l+a>h&&(l+=a),i.scrollTop(l),this.clear(),this.next();break}}}},this.height=function(t){this.scrollHeight(t)},this.size=function(){return l.length},this.count=function(){return l.length},this.list=function(){return l},this.listColumn=function(){return s.listColumn()},this.listData=function(){for(var t=[],e=0;e<l.length;e++)t.push(l[e].data);return t},this.get=function(t){if(null==t)return null;if(n=h[t])return n;for(var e=g.getIndexList(t),n=h[e[0]],i=1,o=e.length;i<o&&n;i++)n=n.children[e[i]];return n},this.findAll=function(e,n){var i=this.get(e);if(null!=i){t.typeCheck("array",n)||(n=[i]);for(var o=0;o<i.children.length;o++){var s=i.children[o];n.push(s),s.children.length>0&&this.findAll(s.index,n)}}},this.getColumn=function(t){return s.getColumn(t)},this.getData=function(t){var e=this.get(t);return e?e.data:null},this.showColumn=function(t){s.showColumn(t)},this.hideColumn=function(t){s.hideColumn(t)},this.initColumns=function(t){s.initColumns(t),r.initColumns(t),s.emit("colresize")},this.showColumnMenu=function(t,e){s.showColumnMenu(t,e)},this.hideColumnMenu=function(){s.hideColumnMenu()},this.toggleColumnMenu=function(t,e){s.toggleColumnMenu(t,e)},this.showExpand=function(t,e){r.showExpand(t,e)},this.hideExpand=function(t){t?r.hideExpand(t):r.hideExpand()},this.getExpand=function(){return r.getExpand()},this.showLoading=function(t){if(c&&!f&&(c.show(),f=!0,t>0)){var e=this;setTimeout(function(){e.hideLoading()},t)}},this.hideLoading=function(){c&&f&&(c.hide(),f=!1)},this.isLoading=function(){return f},this.setCsv=function(e){var n=this.options;if(n.fields||n.csv){var i=t.getCsvFields(n.fields,n.csv),o=n.csvNumber?t.getCsvFields(n.fields,n.csvNumber):null;this.update(t.csvToData(i,e,o))}},this.setCsvFile=function(e){if(this.options.fields||this.options.csv){var n=this;t.fileToCsv(e,function(t){n.setCsv(t)})}},this.getCsv=function(){if(this.options.fields||this.options.csv){var e=t.getCsvFields(this.options.fields,this.options.csv),n=l.length>this.options.csvCount?this.options.csvCount:l.length;return t.dataToCsv2({fields:e,rows:this.listData(),count:n,names:this.options.csvNames})}},this.getCsvBase64=function(){if(this.options.fields||this.options.csv)return t.csvToBase64(this.getCsv())},this.downloadCsv=function(e){t.typeCheck("string",e)&&(e=e.split(".")[0]);var n=document.createElement("a");n.download=e?e+".csv":"table.csv",n.href=this.getCsvBase64(),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n)},this.rowFunc=function(t,e,n){if(this.options.fields){var i="function"==typeof n,o=0,r=i?0:l.length,h=s.getColumn(e);if(h.name)for(var u=0;u<l.length;u++){var a=l[u].data[h.name];isNaN(a)||(i?n(l[u])&&(o+=a,r++):o+=a)}return"sum"==t?o:"avg"==t?o/r:null}},this.getPage=function(){return d-1},this.activeIndex=function(){return v?v.index:null}};return s.setup=function(){return{fields:null,csv:null,csvNames:null,csvNumber:null,csvCount:1e4,data:[],rows:null,colshow:!1,expand:!1,expandEvent:!0,resize:!1,rowHeight:26,scrollHeight:200,scrollWidth:0,width:0,buffer:"scroll",bufferCount:100,msort:!1,sort:!1,sortLoading:!1,sortCache:!1,sortIndex:null,sortOrder:"asc",sortEvent:!0,xssFilter:!1,animate:!1}},s}};h.use(m,g),window.jui=window.JUI=h},function(t,e){}]);